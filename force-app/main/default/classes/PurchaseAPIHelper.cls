public with sharing class PurchaseAPIHelper {
    public static String getStateCode(String stateName) {
    Map<String, String> stateCodeMapping = new Map<String, String>{
        'Alabama'         => 'AL',
        'Alaska'          => 'AK',
        'Arizona'         => 'AZ',
        'Arkansas'        => 'AR',
        'California'      => 'CA',
        'Colorado'        => 'CO',
        'Connecticut'     => 'CT',
        'Delaware'        => 'DE',
        'Florida'         => 'FL',
        'Georgia'         => 'GA',
        'Hawaii'          => 'HI',
        'Idaho'           => 'ID',
        'Illinois'        => 'IL',
        'Indiana'         => 'IN',
        'Iowa'            => 'IA',
        'Kansas'          => 'KS',
        'Kentucky'        => 'KY',
        'Louisiana'       => 'LA',
        'Maine'           => 'ME',
        'Maryland'        => 'MD',
        'Massachusetts'   => 'MA',
        'Michigan'        => 'MI',
        'Minnesota'       => 'MN',
        'Mississippi'     => 'MS',
        'Missouri'        => 'MO',
        'Montana'         => 'MT',
        'Nebraska'        => 'NE',
        'Nevada'          => 'NV',
        'New Hampshire'   => 'NH',
        'New Jersey'      => 'NJ',
        'New Mexico'      => 'NM',
        'New York'        => 'NY',
        'North Carolina'  => 'NC',
        'North Dakota'    => 'ND',
        'Ohio'            => 'OH',
        'Oklahoma'        => 'OK',
        'Oregon'          => 'OR',
        'Pennsylvania'    => 'PA',
        'Rhode Island'    => 'RI',
        'South Carolina'  => 'SC',
        'South Dakota'    => 'SD',
        'Tennessee'       => 'TN',
        'Texas'           => 'TX',
        'Utah'            => 'UT',
        'Vermont'         => 'VT',
        'Virginia'        => 'VA',
        'Washington'      => 'WA',
        'West Virginia'   => 'WV',
        'Wisconsin'       => 'WI',
        'Wyoming'         => 'WY'
    };
    stateName = stateName.trim().toUpperCase();
    return stateCodeMapping.containsKey(stateName) ? stateCodeMapping.get(stateName) : null;
    }
}